<div class="container">
    <div class="d-flex justify-content-center align-items-center mt-4">
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
            <div class="d-flex flex-column align-items-center justify-content-center"
                style="background-color: #ffd4aa; padding: 20px; border-radius: 15px;">
                <div
                    style="background-color: #dd5b4d; width: 100%; text-align: center; padding: 20px; border-radius: 15px;">
                    <img src="{{usuario.url_foto}}" class="rounded-circle" style="width: 100px; height: 100px">
                    <h2 class="mt-3" style="color: #fff5e6;">{{usuario.nombre | titlecase }} {{usuario.apellido_uno
                        | titlecase }} {{usuario.apellido_dos | titlecase }}</h2>
                    <p class="text-muted mb-0">{{usuario.email}}</p>
                    <p>{{usuario.id_examen}}</p>
                </div>
                <div class="d-flex justify-content-around mt-2 mb-2 w-100">
                    <button class="btn btn-warning" btn-lg data-bs-toggle="modal" data-bs-target="#modalPerfil"
                        (click)="getPerfil()"><i class="fas fa-edit"></i></button>
                    <button class="btn btn-warning" btn-lg data-bs-toggle="modal" data-bs-target="#modalNueva"> <i
                            class="fa-solid fa-key"></i></button>
                </div>
                <!--<p>Total concursos participado: {{ getTotalConcursosParticipado() }}</p>
                        <p>Total actividades participado: {{ getTotalActividadesParticipado() }}</p>-->
            </div>
        </div>
    </div>

    <div class="card shadow mb-4" style="background-color: #dd5b4dbc;">
        <div class="card-header text-center" style="background-color: #ffb062;">
            <h2 class="mt-3" style="color: #fff5e6;">CONCURSOS EN LOS QUE HE PARTICIPADO</h2>
        </div>
        <div class="card-body mt-4">
            <div class="row d-flex justify-content-center">
                @for(concurso of concursos; track concurso.id) {
                <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                    <div class="card card-blog card-plain d-flex align-items-center justify-content-center"
                        style="background-color: #ffd4aa;">
                        <div class="position-relative ">
                            <a class="d-inline shadow-xl border-radius-xl" style="width: 100%; height: auto; ">
                                <img src="{{concurso.url_foto}}" alt="Fotografía de {{concurso.nombre}}"
                                    class="img-fluid shadow border-radius-xl">
                            </a>
                        </div>
                        <div class="card-body justify-content-center align-items-center">
                            <a href="javascript:;" class="text-center">
                                <h5 style="font-size: 30px; color: #dd5b4d;">
                                    {{concurso.nombre | titlecase}}
                                </h5>
                                <h6>
                                    {{concurso.descripcion | titlecase}}
                                </h6>

                            </a>

                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #dd5b4d; border-radius: 10px">
                                Solución: {{concurso.solucion | titlecase}}
                            </p>


                            <button class="btn btn-warning" btn-lg data-bs-toggle="modal"
                                data-bs-target="#modalActividades" (click)=" getActividadesPorConcurso(concurso.id)"><i
                                    class="fa-solid fa-eye mr-2 "></i>Actividades</button>
                        </div>
                    </div>
                </div>
                }
            </div>
        </div>
    </div>

    <div class="card shadow mb-4 " style="background-color: #dd5b4dbc;">
        <div class="card-header text-center" style="background-color: #e47266;">
            <h2 class="mt-3" style="color: #fff5e6;">ACTIVIDADES DE UN UNICO CONTACTO EN LAS QUE HE PARTICIPADO</h2>
        </div>
        <div class="card-body mt-4">
            <div class="row d-flex justify-content-center">
                @for(actividadUnico of actividadesUnico; track actividadUnico.id) {
                <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                    <div class="card card-blog card-plain d-flex align-items-center justify-content-center"
                        style="background-color: #ffd4aa;">
                        <div class="position-relative w-100">
                            <a class="d-inline shadow-xl border-radius-xl" style="width: 100%; height: auto; ">
                                <img src="{{actividadUnico?.url_foto}}" alt="Fotografía de {{actividadUnico?.nombre}}"
                                    class="img-fluid shadow border-radius-xl">
                            </a>
                        </div>
                        <div class="card-body justify-content-center align-items-center text-center">
                            <h5 style="font-size: 30px; color: #dd5b4d;">
                                {{actividadUnico?.nombre}}
                            </h5>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Localización: {{actividadUnico.localizacion | titlecase}}</p>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Fecha: {{actividadUnico.fecha | date:'shortDate'}}</p>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Frecuencia: {{actividadUnico.frecuencia | titlecase}}</p>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">

                                Banda: {{actividadUnico.banda | titlecase}}</p>

                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Modalidad: {{actividadUnico.modalidad.descripcion | titlecase}}</p>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Modo: {{actividadUnico.modo.nombre | titlecase}}</p>

                            @for(act_primaria of actividadUnico.act_primarias; track act_primaria.id) {
                            <h6 class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #C22741; border-radius: 10px">Concurso: {{act_primaria.nombre
                                | titlecase}}</h6>
                            }
                            <p class="text-sm text-center"
                                [ngStyle]="{'background-color': actividadUnico.completada ? '#dd5b4d' : '#ffb062'}"
                                style="border-radius: 10px">{{actividadUnico.completada ? 'Terminada' : 'Activa'}}</p>
                            <button class="btn btn-danger mr-2"
                                (click)="pedirDiploma(actividadVarios.nombre, actividadVarios.url_foto)"><i
                                    class="fa-solid fa-award ml-2 mr-2"></i>
                                Diploma <i class="fa-solid fa-award ml-2 mr-2"></i></button>
                        </div>
                    </div>
                </div>
                }
            </div>
            <p-messages [(value)]="mensaje" [enableService]="false" [closable]="true"></p-messages>
        </div>
    </div>
    <div class="card shadow " style="background-color: #dd5b4dbc;">
        <div class="card-header text-center" style="background-color: #dd5b4d;">
            <h2 class="mt-3" style="color: #fff5e6;">ACTIVIDADES DE VARIOS CONTACTOS EN LAS QUE HE PARTICIPADO</h2>
        </div>
        <div class="card-body mt-4">
            <div class="row d-flex justify-content-center">
                @for(actividadVarios of actividadesVarios; track actividadVarios.id) {
                <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                    <div class="card card-blog card-plain d-flex align-items-center justify-content-center"
                        style="background-color: #ffd4aa;">
                        <div class="position-relative w-100">
                            <a class="d-inline shadow-xl border-radius-xl" style="width: 100%; height: auto; ">
                                <img src="{{actividadVarios?.url_foto}}" alt="Fotografía de {{actividadVarios?.nombre}}"
                                    class="img-fluid shadow border-radius-xl">
                            </a>
                        </div>
                        <div class="card-body justify-content-center align-items-center text-center">
                            <h5 style="font-size: 30px; color: #dd5b4d;">
                                {{actividadVarios?.nombre}}
                            </h5>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Localización: {{actividadVarios.localizacion | titlecase}}</p>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Fecha: {{actividadVarios.fecha | date:'shortDate'}}</p>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Frecuencia: {{actividadVarios.frecuencia}}</p>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Banda: {{actividadVarios.banda | titlecase}}</p>

                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Modalidad: {{actividadVarios.modalidad.descripcion | titlecase}}</p>
                            <p class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #ffb062; border-radius: 10px">
                                Modo: {{actividadVarios.modo.nombre | titlecase}}</p>

                            @for(act_primaria of actividadVarios.act_primarias; track act_primaria.id) {
                            <h6 class="mb-4 mt-4 text-sm text-center"
                                style=" border: 2px solid #C22741; border-radius: 10px">Concurso: {{act_primaria.nombre
                                | titlecase}}</h6>
                            }
                            <p class="text-sm text-center"
                                [ngStyle]="{'background-color': actividadVarios.completada ? '#dd5b4d' : '#ffb062'}"
                                style="border-radius: 10px">{{actividadVarios.completada ? 'Terminada' : 'Activa'}}</p>

                            <button class="btn btn-danger mr-2"
                                (click)="pedirDiploma(actividadVarios.nombre, actividadVarios.url_foto)"><i
                                    class="fa-solid fa-award ml-2 mr-2"></i>
                                Diploma<i class="fa-solid fa-award ml-2 mr-2"></i></button>

                        </div>
                    </div>
                </div>
                }
            </div>
            <p-messages [(value)]="mensaje" [enableService]="false" [closable]="true"></p-messages>
        </div>
    </div>


    <!-- Modal para cambiar contraseña -->

    <div class="modal fade" id="modalNueva" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header text-center align-items-center "
                    style="background-color: #dd5b4d; padding: 10px 30px;">
                    <h5 class="modal-title" id="modalLabel">Cambiar contraseña</h5>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal" aria-label="Cerrar"><i
                            class="fa-solid fa-xmark"></i></button>
                </div>
                <div class="modal-body" style="background-color: #ffb062; padding: 10px 30px;">

                    <p>
                        Introduce tu correo electrónico para cambiar tu contraseña * : <input type="email"
                            [(ngModel)]="email" class="form-control" />
                    </p>

                    <p>
                        Introduce tu contraseña antigua * : <input type="password" [(ngModel)]="passwordAntigua"
                            class="form-control" />
                    </p>

                    <p>
                        Introduce tu nueva contraseña * : <input type="password" [(ngModel)]="passwordNueva"
                            class="form-control" />
                    </p>

                </div>
                <div class="modal-footer" style="background-color: #dd5b4d;">

                    <button class="btn btn-success mr-2"
                        (click)="cambiarPassword(email, passwordAntigua, passwordNueva)"><i
                            class="fa-solid fa-circle-check"></i>
                    </button>

                    <p-messages [(value)]="mensaje" [enableService]="false" [closable]="true"></p-messages>

                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para modificar perfil  -->

    <div class="modal fade" id="modalPerfil" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header text-center align-items-center "
                    style="background-color: #dd5b4d; padding: 10px 30px;">
                    <h5 class="modal-title" id="modalLabel">Crea y modifica los concursos</h5>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal" aria-label="Cerrar"><i
                            class="fa-solid fa-xmark"></i></button>
                </div>
                <div class="modal-body" style="background-color: #ffb062; padding: 10px 30px;">
                    <p>
                        Nombre *:<input type="text" [(ngModel)]="usuario.nombre" class="form-control" />
                    </p>
                    <p>
                        Apellido 1 *:<input type="text" [(ngModel)]="usuario.apellido_uno" class="form-control" />
                    </p>
                    <p>
                        Apellido 2 *:<input type="text" [(ngModel)]="usuario.apellido_dos" class="form-control" />
                    </p>
                    <p>
                        Foto : <input type="file" (change)="imagen($event)" />
                    </p>

                    <p>
                        Indicativo: <input type="text" [(ngModel)]="usuario.id_examen" class="form-control" />
                    </p>

                </div>
                <div class="modal-footer" style="background-color: #dd5b4d;">

                    <button class="btn btn-warning mr-3" (click)="modificarPerfil()"><i
                            class="fas fa-edit"></i></button>

                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <p-messages [(value)]="mensajeModificado" class="messages-top-right" [enableService]="false"
                        [closable]="true"></p-messages>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para Mostrar las actividades de un concurso -->

    <div class="modal fade" id="modalActividades" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header text-center align-items-center "
                    style="background-color: #dd5b4d; padding: 10px 30px;">
                    <h5 class="modal-title" id="modalLabel">Actividades del Concurso</h5>
                    <button type="button" class="btn btn-danger" data-bs-dismiss="modal" aria-label="Cerrar"><i
                            class="fa-solid fa-xmark"></i></button>
                </div>
                <div class="modal-body" style="background-color: #ffb062; padding: 10px 30px;">
                    <div class="row">
                        <div class="col-12">
                            @for(actividadVarios of actividadesVarios; track actividadVarios.id){
                            <div class="card mb-3">
                                <div class="row g-0">
                                    <div class="col-md-12">
                                        <div class="card-header"
                                            style="background-color: #fff5e6; padding: 30px 30px; ">
                                            <h5 class="card-title" style="margin: 0px !important;">
                                                {{actividadVarios.nombre |
                                                titlecase}}</h5>
                                        </div>
                                        <div class="card-body" style="background-color: #fff5e6; padding: 30px 30px;">

                                            <p class="card-text">Localización: {{actividadVarios.localizacion |
                                                titlecase}}</p>
                                            <p class="card-text"> Fecha: {{actividadVarios.fecha | date:'shortDate'}}
                                            </p>
                                            <p class="card-text">Frecuencia: {{actividadVarios.frecuencia | titlecase}}
                                            </p>
                                            <p class="card-text">Banda: {{actividadVarios.banda | titlecase}}</p>
                                    
                                            <p class="card-text">Modalidad: {{actividadVarios.modalidad.descripcion |
                                                titlecase}}
                                            </p>
                                            <p class="card-text">Modo: {{actividadVarios.modo.nombre | titlecase}}</p>
                                            <p class="text-sm text-center"
                                            [ngStyle]="{'background-color': actividadVarios.completada ? '#dd5b4d' : '#ffb062'}"
                                            style="border-radius: 10px">
                                            {{actividadVarios.completada ? 'Terminada' : 'Activa'}}
                                        </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>